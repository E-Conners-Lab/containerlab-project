! main-agg1 - Phase 5: Main Campus Aggregation
! Loopback: 10.255.10.1
! Gi2 -> core1 (10.0.1.0/31)
! Gi3 -> core2 (10.0.1.2/31)
! Gi4 -> main-edge1 (10.0.1.4/31)
! Gi5 -> main-edge2 (10.0.1.6/31)

interface Loopback0
 ip address 10.255.10.1 255.255.255.255
 ip ospf 1 area 0
 no shutdown

interface GigabitEthernet2
 description to core1
 ip address 10.0.1.1 255.255.255.254
 ip ospf network point-to-point
 ip ospf 1 area 0
 mpls ip
 no shutdown

interface GigabitEthernet3
 description to core2
 ip address 10.0.1.3 255.255.255.254
 ip ospf network point-to-point
 ip ospf 1 area 0
 mpls ip
 no shutdown

interface GigabitEthernet4
 description to main-edge1
 ip address 10.0.1.4 255.255.255.254
 ip ospf network point-to-point
 ip ospf 1 area 0
 mpls ip
 no shutdown

interface GigabitEthernet5
 description to main-edge2
 ip address 10.0.1.6 255.255.255.254
 ip ospf network point-to-point
 ip ospf 1 area 0
 mpls ip
 no shutdown

router ospf 1
 router-id 10.255.10.1
 passive-interface Loopback0

mpls ldp router-id Loopback0 force

router bgp 65001
 bgp router-id 10.255.10.1
 bgp log-neighbor-changes
 no bgp default ipv4-unicast
 neighbor 10.255.1.1 remote-as 65001
 neighbor 10.255.1.1 update-source Loopback0
 neighbor 10.255.1.1 description core1-RR
 neighbor 10.255.1.2 remote-as 65001
 neighbor 10.255.1.2 update-source Loopback0
 neighbor 10.255.1.2 description core2-RR
 neighbor 10.255.1.5 remote-as 65001
 neighbor 10.255.1.5 update-source Loopback0
 neighbor 10.255.1.5 description core5-RR
 !
 address-family vpnv4
  neighbor 10.255.1.1 activate
  neighbor 10.255.1.1 send-community extended
  neighbor 10.255.1.2 activate
  neighbor 10.255.1.2 send-community extended
  neighbor 10.255.1.5 activate
  neighbor 10.255.1.5 send-community extended
 exit-address-family
