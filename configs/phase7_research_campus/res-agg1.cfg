! res-agg1 - Phase 7: Research Campus Aggregation
! Loopback: 10.255.30.1
! Gi2 -> core4 (10.0.3.0/31)
! Gi3 -> core5 (10.0.3.2/31)
! Gi4 -> res-edge1 (10.0.3.4/31)
! Gi5 -> res-edge2 (10.0.3.6/31)

interface Loopback0
 ip address 10.255.30.1 255.255.255.255
 ip ospf 1 area 0
 no shutdown

interface GigabitEthernet2
 description to core4
 ip address 10.0.3.1 255.255.255.254
 ip ospf network point-to-point
 ip ospf 1 area 0
 mpls ip
 no shutdown

interface GigabitEthernet3
 description to core5
 ip address 10.0.3.3 255.255.255.254
 ip ospf network point-to-point
 ip ospf 1 area 0
 mpls ip
 no shutdown

interface GigabitEthernet4
 description to res-edge1
 ip address 10.0.3.4 255.255.255.254
 ip ospf network point-to-point
 ip ospf 1 area 0
 mpls ip
 no shutdown

interface GigabitEthernet5
 description to res-edge2
 ip address 10.0.3.6 255.255.255.254
 ip ospf network point-to-point
 ip ospf 1 area 0
 mpls ip
 no shutdown

router ospf 1
 router-id 10.255.30.1
 passive-interface Loopback0

mpls ldp router-id Loopback0 force

router bgp 65001
 bgp router-id 10.255.30.1
 bgp log-neighbor-changes
 no bgp default ipv4-unicast
 neighbor 10.255.1.1 remote-as 65001
 neighbor 10.255.1.1 update-source Loopback0
 neighbor 10.255.1.1 description core1-RR
 neighbor 10.255.1.2 remote-as 65001
 neighbor 10.255.1.2 update-source Loopback0
 neighbor 10.255.1.2 description core2-RR
 neighbor 10.255.1.5 remote-as 65001
 neighbor 10.255.1.5 update-source Loopback0
 neighbor 10.255.1.5 description core5-RR
 !
 address-family vpnv4
  neighbor 10.255.1.1 activate
  neighbor 10.255.1.1 send-community extended
  neighbor 10.255.1.2 activate
  neighbor 10.255.1.2 send-community extended
  neighbor 10.255.1.5 activate
  neighbor 10.255.1.5 send-community extended
 exit-address-family
